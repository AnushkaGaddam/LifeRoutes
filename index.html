<!DOCTYPE html>
<html lang="en">
<head>
    <title>LifeRoute - Smart Emergency Locator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.css" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

        :root {
            --primary: #04204e;
            --secondary: #2459ae;
            --accent: #ffcc00;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        /* --- ANIMATIONS --- */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .animate-fade { animation: fadeIn 0.8s ease-out; }
        .animate-up { animation: fadeInUp 0.6s ease-out forwards; }

        /* --- NAVBAR --- */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 8%;
            background: rgb(224, 221, 240);
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            
            top: 0;
            z-index: 1000;
        }

        .logo { display: flex; align-items: center; gap: 12px; }
        .logo img { height: 45px; }
        .logo span { font-size: 22px; font-weight: 700; color: var(--primary); }

        .nav-links { list-style: none; display: flex; gap: 30px; }
        .nav-links li { 
            cursor: pointer; 
            font-weight: 500; 
            transition: 0.3s; 
            position: relative;
        }
        .nav-links li:hover { color: var(--secondary); }
        .nav-links li::after {
            content: ''; width: 0; height: 2px; background: var(--secondary);
            position: absolute; bottom: -5px; left: 0; transition: 0.3s;
        }
        .nav-links li:hover::after { width: 100%; }

        /* --- SECTIONS --- */
        .page-section { display: none; padding: 60px 8%; min-height: 80vh; }
        .active { display: block; animation: fadeIn 0.5s ease; }

        /* --- HERO --- */
        .hero {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 40px;
            padding: 40px 0;
        }
        .hero-text h1 { font-size: 48px; color: var(--primary); line-height: 1.2; margin-bottom: 20px; }
        .hero-text p { font-size: 18px; color: #555; margin-bottom: 30px; }

        .btn-main {
            background: var(--primary);
            color: white;
            padding: 16px 32px;
            border: none;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.4s;
            box-shadow: 0 10px 20px rgba(4, 32, 78, 0.2);
        }
        .btn-main:hover {
            background: var(--secondary);
            transform: scale(1.05);
            box-shadow: 0 15px 25px rgba(4, 32, 78, 0.3);
        }

        .hero-image img {
            width: 100%;
            max-width: 500px;
            border-radius: 20px;
            animation: float 4s ease-in-out infinite;
        }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }

        /* --- EMERGENCY MODAL --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            display: none; justify-content: center; align-items: center;
            z-index: 2000;
        }
        .modal-card {
            background: white; padding: 40px; border-radius: 25px;
            width: 90%; max-width: 900px; text-align: center;
            position: relative; transform: scale(0.9); transition: 0.3s;
        }
        .modal-card.show { transform: scale(1); }

        .emergency-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px; margin: 30px 0;
        }
        .cond-card {
            background: #748ba0; padding: 25px; border-radius: 15px;
            cursor: pointer; border: 2px solid transparent; transition: 0.3s;
        }
        .cond-card:hover { 
            transform: translateY(-5px); 
            border-color: var(--secondary);
            background: #eef2ff;
        }
        .cond-card.selected { border-color: var(--success); background: #e6ffed; }
        .cond-card h3 { font-size: 20px; margin-bottom: 8px; }

        #btn-detect {
            display: none; background: var(--success); color: white;
            padding: 15px 40px; border: none; border-radius: 50px;
            font-weight: 600; cursor: pointer; margin-top: 20px;
        }

        /* --- MAP SECTION --- */
        #map-container { 
            width: 100%; 
            margin-top: 30px; 
            display: none; 
        }
        #map { 
            height: 600px; 
            width: 100%; 
            border-radius: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); 
        }
        .map-header { text-align: center; padding: 30px 0; }

        /* --- HOSPITAL LIST --- */
        .hospital-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px; margin-top: 40px;
        }
        .hosp-card {
            background: white; padding: 25px; border-radius: 18px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: 0.4s; border-left: 8px solid #ccc;
        }
        .hosp-card:hover { transform: translateY(-10px); box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        
        /* Scoring Styles */
        .risk-low { border-left-color: var(--success); }
        .risk-med { border-left-color: var(--warning); }
        .risk-high { border-left-color: var(--danger); }

        .easy-access-badge {
            display: inline-block;
            border: 2px dotted var(--success);
            color: var(--success);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            margin-top: 10px;
        }

        /* --- CARDS (ABOUT & CONTACT) --- */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px; margin-top: 40px;
        }
        .square-card {
            background: var(--primary); color: white;
            padding: 40px; border-radius: 20px; text-align: center;
            transition: 0.4s; height: 300px;
            display: flex; flex-direction: column; justify-content: center;
        }
        .square-card:hover {
            background: var(--secondary);
            transform: rotate(2deg) scale(1.05);
        }
        .square-card h3 { margin-bottom: 15px; font-size: 24px; color: var(--accent); }

        /* --- SIDE PANEL --- */
        #sidePanel {
            position: fixed; top: 0; right: -450px; width: 400px; height: 100%;
            background: white; z-index: 3000; transition: 0.5s;
            padding: 40px 20px; box-shadow: -10px 0 30px rgba(0,0,0,0.1);
            overflow-y: auto;
        }
        #sidePanel.open { right: 0; }
        .close-panel { cursor: pointer; font-size: 24px; float: right; }
        /*Ai voice speech style*/
        @keyframes pulseMic {
    0% { transform: scale(1); box-shadow:0 0 0 0 rgba(255,0,0,0.7); }
    70% { transform: scale(1.1); box-shadow:0 0 0 25px rgba(255,0,0,0); }
    100% { transform: scale(1); }
}

    </style>
</head>
<body>

<nav class="navbar animate-fade">
    <div class="logo">
        <!-- REPLACE WITH YOUR LOCAL LOGO PATH -->
        <img src="C:\Users\Gaddam Anushka\Pictures\Screenshots\logo.png" onerror="this.src='https://cdn-icons-png.flaticon.com/512/809/809957.png'" alt="Logo">
        <span>LifeRoute-Smart Management System</span>
    </div>
    <ul class="nav-links">
        <li onclick="showSection('home')"><b>Home</b></li>
        <li onclick="showSection('about')"><b>About Us</b></li>
        <li onclick="showSection('contact')"><b>Contact Us</b></li>
        <li onclick="window.location.href='traffic-flow.html'">
        <b style="color:#150204;">Traffic Flow</b>
        <li onclick="window.location.href='Control-room.html'">
        <b style="color:#150204;">Control-Room</b>
    </ul>
</nav>

<!-- HOME SECTION -->
<section id="home" class="page-section active">
    <div class="hero">
        <div class="hero-text animate-up">
            <h1>Every Second Counts. <br>Find the Right Hospital.</h1>
            <p>Smart routing based on real-time facility availability and readiness for your specific medical emergency.</p>
            <button class="btn-main" onclick="openModal()">Select Emergency Type</button>
   <button class="btn-main" onclick="openVoiceAssistant()" 
style="margin-left:15px;background:#dc3545;">
 AI Voice
</button>

<button class="btn-main" onclick="openLensAI()" 
style="margin-left:15px;background:#0e04c0;">
 LensAI
</button>
        </div>
        <div class="hero-image animate-fade">
            <!-- REPLACE WITH YOUR LOCAL AMBULANCE IMAGE -->
            <img src="C:\Users\Gaddam Anushka\Downloads\ambulance.png" onerror="this.src='https://cdn-icons-png.flaticon.com/512/1023/1023656.png'" alt="Emergency">
        </div>
    </div>

    <!-- Map Area (Hidden until location detected) -->
    <div id="map-container">
        <div class="map-header">
            <h2 id="rec-title">Recommended Hospitals for you</h2>
        </div>
        <div id="map"></div>
        <div id="hospitalList" class="hospital-grid"></div>
    </div>
</section>

<!-- ABOUT SECTION -->
<section id="about" class="page-section">
    <h1 style="text-align: center; color: var(--primary);">About LifeRoute</h1>
    <div class="info-grid">
        <div class="square-card">
            <h3 style="color: rgb(3, 3, 11);">Our Mission</h3>
            <p>To reduce emergency response time by connecting patients with hospitals that actually have the required facilities ready.</p>
        </div>
        <div class="square-card">
            <h3 style="color: rgb(3, 3, 11);">Smart Routing</h3>
            <p>Our algorithm calculates 'Readiness Scores' considering ICU availability, specialized doctors, and travel time.</p>
        </div>
        <div class="square-card">
            <h3 style="color: rgb(3, 3, 11);">Reliability</h3>
            <p>24/7 real-time tracking and facility verification to ensure you never reach a hospital that can't treat you.</p>
        </div>
    </div>
</section>

<!-- CONTACT SECTION -->
<section id="contact" class="page-section">
    <h1 style="text-align: center; color: var(--primary);">Emergency Contacts</h1>
    <div class="info-grid">
        <div class="square-card">
            <h3 style="color: rgb(204, 215, 56);">Ambulance</h3>
            <h1 style="font-size: 50px;">108</h1>
            <p>National Emergency Helpline</p>
        </div>
        <div class="square-card">
            <h3 style="color: rgb(234, 11, 11);">Helpline</h3>
            <h3>+91 8639611200</h3>
            <p>Direct Support Line</p>
        </div>
        <div class="square-card">
            <h3 style="color: rgb(43, 231, 22);">WhatsApp</h3>
            <h3>+91 91234 56789</h3>
            <p>Text for quick assistance</p>
        </div>
    </div>
</section>

<!-- EMERGENCY MODAL -->
<div id="emergencyModal" class="modal-overlay">
    <div class="modal-card">
        <span style="position:absolute; right:25px; top:15px; cursor:pointer; font-size:30px;" onclick="closeModal()">&times;</span>
        <h2>Select Emergency Type</h2>
        <p>This helps us find hospitals with specific facilities (e.g., Ventilators, Maternity Ward)</p>
        
        <div class="emergency-grid">
            <div class="cond-card" onclick="selectCond('Labour', this)"><h3> Labour Pains</h3><p>Maternity & ICU</p></div>
            <div class="cond-card" onclick="selectCond('Accident', this)"><h3> Accident</h3><p>Trauma & Surgery</p></div>
            <div class="cond-card" onclick="selectCond('Heart', this)"><h3> Heart Attack</h3><p>Cardiology & ICU</p></div>
            <div class="cond-card" onclick="selectCond('Stroke', this)"><h3> Brain Stroke</h3><p>Neurology Dept</p></div>
            <div class="cond-card" onclick="selectCond('Breathing', this)"><h3> Breathing</h3><p>Oxygen & Vent</p></div>
            <div class="cond-card" onclick="selectCond('Seizure', this)"><h3> Seizure</h3><p>Critical Care</p></div>
        </div>
        
        <button id="btn-detect" onclick="startDetection()">Detect My Location</button>
    </div>
</div>

<!-- SIDE DETAILS PANEL -->
<div id="sidePanel">
    <span class="close-panel" onclick="togglePanel(false)">&times;</span>
    <div id="panelContent"></div>
</div>
<!-- AI VOICE OVERLAY -->
<div id="voiceOverlay" style="
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.9);
display:none;
flex-direction:column;
justify-content:center;
align-items:center;
z-index:5000;
color:white;
">

<h2 id="voiceStatus">Listening...</h2>

<div id="voiceTranscript" style="
margin-top:20px;
font-size:22px;
text-align:center;
min-height:40px;
max-width:80%;
"></div>

<div id="voiceMic" style="
margin-top:40px;
width:120px;
height:120px;
background:#ff3b3b;
border-radius:50%;
display:flex;
justify-content:center;
align-items:center;
font-size:40px;
animation:pulseMic 1.3s infinite;
">
üé§
</div>

<button onclick="closeVoiceAssistant()" style="
margin-top:40px;
padding:10px 25px;
border:none;
border-radius:20px;
cursor:pointer;
">
Cancel
</button>

</div>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.js"></script>
<!-- ================= LENS AI OVERLAY ================= -->
<div id="lensOverlay" style="
position:fixed;
inset:0;
background:black;
display:none;
z-index:10000;
">

    <iframe src="Lensai.html" 
    style="width:100%; height:100%; border:none;">
    </iframe>

    <button onclick="closeLensAI()" style="
    position:absolute;
    top:20px;
    right:25px;
    background:white;
    border:none;
    padding:8px 15px;
    border-radius:20px;
    cursor:pointer;
    font-weight:bold;
    z-index:10001;">
    ‚úï Close
    </button>

</div>
<script>
    const socket = io("http://localhost:5000");

socket.on("connect", () => {
    console.log("Connected to Emergency Server");
});
    let map, userMarker, routeLayer;
    let selectedCondition = "";
    let allHospitals = [];

    const requirements = {
        'Labour': ['Maternity', 'ICU', 'Oxygen'],
        'Accident': ['TraumaCare', 'Surgery', 'Ventilator'],
        'Heart': ['Cardiologist', 'ICU', 'Oxygen'],
        'Stroke': ['Neurologist', 'ICU', 'Ventilator'],
        'Breathing': ['Ventilator', 'Oxygen', 'ICU'],
        'Seizure': ['ICU', 'Neurologist']
    };

    function showSection(id) {
        document.querySelectorAll('.page-section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        window.scrollTo(0,0);
    }

    function openModal() {
        document.getElementById('emergencyModal').style.display = 'flex';
        setTimeout(() => document.querySelector('.modal-card').classList.add('show'), 10);
    }

    function closeModal() {
        document.querySelector('.modal-card').classList.remove('show');
        setTimeout(() => document.getElementById('emergencyModal').style.display = 'none', 300);
    }

    function selectCond(cond, el) {
        selectedCondition = cond;
        document.querySelectorAll('.cond-card').forEach(c => c.classList.remove('selected'));
        el.classList.add('selected');
        document.getElementById('btn-detect').style.display = 'inline-block';
    }

    function startDetection() {
        closeModal();
        document.getElementById('map-container').style.display = 'block';
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(pos => {
                const { latitude, longitude } = pos.coords;
                initMap(latitude, longitude);
            });
        }
    }

    function initMap(lat, lng) {
        if (!map) {
            map = L.map('map').setView([lat, lng], 13);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
        }
        if (userMarker) map.removeLayer(userMarker);
        userMarker = L.marker([lat, lng]).addTo(map).bindPopup("You are here").openPopup();
        
        fetchHospitals(lat, lng);
    }

    function fetchHospitals(lat, lng) {
        // Simulated overpass call - replaced with logic to handle results
        const query = `[out:json];node["amenity"="hospital"](around:5000,${lat},${lng});out;`;
        fetch("https://overpass-api.de/api/interpreter", { method: "POST", body: query })
            .then(res => res.json())
            .then(data => processHospitals(data.elements, lat, lng));
    }

    function processHospitals(data, uLat, uLng) {
        allHospitals = data.map(h => {
            const hLat = h.lat, hLng = h.lon;
            const dist = getDist(uLat, uLng, hLat, hLng);
            
            // Randomly simulate facilities
            const facilities = {
                ICU: Math.random() > 0.3,
                Ventilator: Math.random() > 0.5,
                Oxygen: true,
                Cardiologist: Math.random() > 0.6,
                Neurologist: Math.random() > 0.7,
                Maternity: Math.random() > 0.5,
                TraumaCare: Math.random() > 0.4,
                Surgery: Math.random() > 0.3
            };

            const reqs = requirements[selectedCondition];
            const met = reqs.filter(f => facilities[f]).length;
            const score = Math.round((met / reqs.length) * 100);

            return { name: h.tags.name || "General Hospital", lat: hLat, lng: hLng, dist, facilities, score };
        });

        allHospitals.sort((a, b) => b.score - a.score || a.dist - b.dist);
        renderHospitalList();
        // Automatically route to top recommended hospital
if (allHospitals.length > 0) {

    const bestHospital = allHospitals[0];

    const userLocation = userMarker.getLatLng();

    drawRoute(userLocation, L.latLng(bestHospital.lat, bestHospital.lng));

    // SEND ALERT TO SERVER
    socket.emit("patientAlert", {
        hospitalName: bestHospital.name,
        distance: bestHospital.dist.toFixed(2),
        condition: selectedCondition,
        icuNeeded: bestHospital.facilities.ICU,
        location: {
            lat: userLocation.lat,
            lng: userLocation.lng
        },
        hospitalLat: bestHospital.lat,
        hospitalLng: bestHospital.lng
    });

    console.log(" Emergency Alert Sent to Hospital Dashboard");
}
    }

    function renderHospitalList() {
        const list = document.getElementById('hospitalList');
        list.innerHTML = "";

        allHospitals.slice(0, 6).forEach(h => {
            let riskClass = h.score > 75 ? 'risk-low' : h.score > 40 ? 'risk-med' : 'risk-high';
            let riskText = h.score > 75 ? 'Highly Recommended' : h.score > 40 ? 'Moderate Risk' : 'High Risk';
            let easyBadge = h.score > 80 && h.dist < 3 ? '<div class="easy-access-badge">‚óè Easy Access</div>' : '';

            const card = document.createElement('div');
            card.className = `hosp-card ${riskClass} animate-up`;
            card.innerHTML = `
                <h3>${h.name}</h3>
                <p>Distance: <b>${h.dist.toFixed(2)} km</b></p>
                <p>Readiness Score: <b>${h.score}%</b></p>
                <p style="font-weight:bold; color: var(--primary)">${riskText}</p>
                ${easyBadge}
                <button onclick="focusHospital(${h.lat}, ${h.lng}, '${h.name}')" style="margin-top:15px; padding:8px 15px; cursor:pointer; background:var(--primary); color:white; border:none; border-radius:5px;">View on Map</button>
            `;
            card.onclick = () => showDetails(h);
            list.appendChild(card);
        });
    }

    function focusHospital(lat, lng, name) {
        map.setView([lat, lng], 15);
        const hospitalLatLng = L.latLng(lat, lng);
        L.marker(hospitalLatLng).addTo(map).bindPopup(name).openPopup();
        drawRoute(userMarker.getLatLng(), hospitalLatLng);
        window.scrollTo({ top: document.getElementById('map').offsetTop - 100, behavior: 'smooth' });
    }

    function showDetails(h) {
        const panel = document.getElementById('panelContent');
        panel.innerHTML = `
            <h2>${h.name}</h2>
            <hr><br>
            <p><b>Distance:</b> ${h.dist.toFixed(2)} km</p>
            <p><b>Readiness:</b> ${h.score}%</p>
            <br>
            <h3>Facilities Availability:</h3>
            <ul style="list-style:none; padding:10px;">
                ${Object.entries(h.facilities).map(([key, val]) => `
                    <li style="padding:5px 0; border-bottom:1px solid #eee">
                        ${val ? '‚úì' : '‚úï'} ${key}
                    </li>
                `).join('')}
            </ul>
        `;
        togglePanel(true);
    }

    function togglePanel(open) {
        document.getElementById('sidePanel').classList.toggle('open', open);
    }

    function getDist(lat1, lon1, lat2, lon2) {
        const R = 6371;
        const dLat = (lat2-lat1) * Math.PI/180;
        const dLon = (lon2-lon1) * Math.PI/180;
        const a = Math.sin(dLat/2)**2 + Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLon/2)**2;
        return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    }

    function drawRoute(start, end) {

    // Remove previous route if exists
    if (routeLayer) {
        map.removeControl(routeLayer);
    }

    routeLayer = L.Routing.control({
        waypoints: [
            start,
            end
        ],
        lineOptions: {
            styles: [{ color: 'red', weight: 6 }]
        },
        routeWhileDragging: false,
        draggableWaypoints: false,
        addWaypoints: false,
        createMarker: function () { return null; } // Remove default markers
    }).addTo(map);
}
// ================= AI VOICE ASSISTANT =================

function openVoiceAssistant(){
    document.getElementById("voiceOverlay").style.display = "flex";
    startVoiceRecognition();
}

function closeVoiceAssistant(){
    document.getElementById("voiceOverlay").style.display = "none";
}

function speakResponse(text){
    const speech = new SpeechSynthesisUtterance(text);
    speech.lang = "en-IN";
    window.speechSynthesis.speak(speech);
}

function startVoiceRecognition(){

    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    if(!SpeechRecognition){
        alert("Use Google Chrome for Voice Assistant");
        return;
    }

    const recognition = new SpeechRecognition();
    recognition.lang = "en-IN";
    recognition.interimResults = true;

    recognition.start();

    recognition.onresult = function(event){

        const transcript = event.results[0][0].transcript.toLowerCase();
        document.getElementById("voiceTranscript").innerText = transcript;

        detectEmergency(transcript);
    };

    recognition.onerror = function(){
        speakResponse("Sorry, I could not understand.");
    };
}

// MULTI-LANGUAGE MATCHING
function detectEmergency(text){

    let type = "";

    // ACCIDENT / TRAUMA
    if(
        text.includes("accident") ||
        text.includes("accident ho gaya") ||
        text.includes("durghatna") ||
        text.includes("pramadam") ||
        text.includes("accident ayyindhi") ||
        text.includes("ayyindi") ||
        text.includes("trauma") ||
        text.includes("crash")
    ){
        type = "Accident";
    }

    // HEART ATTACK
    else if(
        text.includes("heart attack") ||
        text.includes("heartattack") ||
        text.includes("dil ka daura") ||
        text.includes("dil ka") ||
        text.includes("gunde noppi") ||
        text.includes("gunde potu") ||
        text.includes("chest pain")
    ){
        type = "Heart";
    }

    // LABOUR / DELIVERY
    else if(
        text.includes("labour pain") ||
        text.includes("labour pains") ||
        text.includes("delivery pain") ||
        text.includes("delivery") ||
        text.includes("prasava vedana") ||
        text.includes("prasava noppi") ||
        text.includes("pregnancy pain")
    ){
        type = "Labour";
    }

    //  STROKE
    else if(
        text.includes("stroke") ||
        text.includes("brain stroke") ||
        text.includes("brain attack") ||
        text.includes("pakshavatham") ||
        text.includes("paralysis") ||
        text.includes("lakwa")
    ){
        type = "Stroke";
    }

    // BREATHING ISSUE
    else if(
        text.includes("breathing problem") ||
        text.includes("saans problem") ||
        text.includes("saans lene mein dikkat") ||
        text.includes("saans lene mein takleef") ||
        text.includes("oopiri") ||
        text.includes("opuri adadam ledhu") ||
        text.includes("asthma")
    ){
        type = "Breathing";
    }

    // SEIZURE
    else if(
        text.includes("seizure") ||
        text.includes("fits") ||
        text.includes("epilepsy")
    ){
        type = "Seizure";
    }

    if(type !== ""){
        selectedCondition = type;

        speakResponse("Detected " + type + " emergency. Finding nearest hospital.");

        setTimeout(() => {
            closeVoiceAssistant();
            startDetection();   // üî• Calls your original logic
        }, 1500);
    }
}

// ================= LENS AI =================

function openLensAI(){
    document.getElementById("lensOverlay").style.display="block";
    document.body.style.overflow="hidden";
}

function closeLensAI(){
    document.getElementById("lensOverlay").style.display="none";
    document.body.style.overflow="auto";
}
</script>

</body>
</html>